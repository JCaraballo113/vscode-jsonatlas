{"version":3,"file":"visualizer.js","sources":["../webview/src/visualizer.ts"],"sourcesContent":["(function () {\n  const vscode = acquireVsCodeApi();\n  const container = document.getElementById('visualizer');\n  const status = document.getElementById('status');\n  const viewSelect = document.getElementById('visualizerViewSelect');\n  const searchInput = document.getElementById('visualizerSearchInput');\n  const chatToggle = document.getElementById('chatToggle');\n  const chatPanel = document.getElementById('chatPanel');\n  const chatClose = document.getElementById('chatClose');\n  const chatReset = document.getElementById('chatReset');\n  const chatMessages = document.getElementById('chatMessages');\n  const chatForm = document.getElementById('chatForm');\n  const chatInput = document.getElementById('chatInput');\n  const chatStatus = document.getElementById('chatStatus');\n  const chatModelSelect = document.getElementById('chatModelSelect');\n  const selectionLineForm = document.getElementById('selectionLineForm');\n  const selectionStartInput = document.getElementById('selectionStartInput');\n  const selectionEndInput = document.getElementById('selectionEndInput');\n  const selectionClearButton = document.getElementById('selectionClearButton');\n  const controlDock = document.getElementById('controlDock');\n  const controlDockPanel = document.getElementById('controlDockPanel');\n  const controlDockToggle = document.getElementById('controlDockToggle');\n\n  if (!container || !status) {\n    vscode.postMessage({ type: 'ready' });\n    return;\n  }\n\n  const graphRoot = document.createElement('section');\n  graphRoot.className = 'visualizer-view visualizer-graph-view';\n  graphRoot.setAttribute('hidden', 'true');\n  container.appendChild(graphRoot);\n\n  const treeRoot = document.createElement('section');\n  treeRoot.className = 'visualizer-view visualizer-tree-view';\n  treeRoot.setAttribute('hidden', 'true');\n  container.appendChild(treeRoot);\n\n  const nodeElements = new Map();\n  const pathDepths = new Map();\n  const collapsedPathStore = new Map();\n  const depthExpandedPathStore = new Map();\n  let collapsedPaths = new Set();\n  let depthExpandedPaths = new Set();\n  let persistedState = typeof vscode.getState === 'function' ? vscode.getState() ?? {} : {};\n  let nodePositionStore = persistedState.nodePositions ?? {};\n  let nodePositions = new Map();\n  let currentDocumentId;\n  let currentEdges = [];\n  let activeNodeDrag;\n\n  let currentPayload;\n  let viewport;\n  let canvas;\n  let nodesLayer;\n  let linksLayer;\n  let isPanning = false;\n  let panPointerId = null;\n  let panStart = { x: 0, y: 0 };\n  let panOrigin = { x: 0, y: 0 };\n  let hasUserMovedView = false;\n  let viewMode = persistedState.viewMode === 'tree' ? 'tree' : 'graph';\n  let hasPersistedViewPreference = typeof persistedState.viewMode === 'string';\n  let preferredDefaultViewMode = hasPersistedViewPreference ? viewMode : 'graph';\n  let graphAutoScale = true;\n  let manualGraphScale = 1;\n  let graphInitialScale = 1;\n  let graphMaxDepth;\n  let searchIndex = new Map();\n  let currentSearchQuery = '';\n  let currentSearchMatch;\n  let pendingSearchFocusId;\n  const chatMessageMap = new Map();\n  let chatPanelVisible = false;\n  let awaitingChatKey = false;\n  let hasAiKey = false;\n  let selectionActive = false;\n  let selectionLabel = '';\n  let selectionLineRange: { start?: number; end?: number } = {};\n  let controlsCollapsed = Boolean(persistedState.controlsCollapsed);\n  let needsInitialGraphFocus = true;\n  let activeModelProvider = 'openai';\n\n  const NODE_GAP_X = 260;\n  const NODE_GAP_Y = 90;\n  const CANVAS_PADDING = 96;\n  const MANUAL_MIN_SCALE = 0.4;\n  const AUTO_MIN_SCALE = 0.02;\n  const AUTO_MAX_SCALE = 1.2;\n  const AUTO_FIT_PADDING = 0.9;\n  const AUTO_VISIBLE_MIN_SCALE = 0.35;\n  const MAX_SCALE = 2.5;\n  const ICON_TYPES = {\n    object: 'object',\n    array: 'array',\n    string: 'string',\n    number: 'number',\n    boolean: 'boolean',\n    null: 'null',\n    link: 'link',\n    unknown: 'unknown'\n  };\n  const EDITABLE_VALUE_KINDS = new Set(['string', 'number', 'boolean', 'null', 'link']);\n  const ROOT_PATH = JSON.stringify([]);\n  const ICON_SVGS = {\n    object:\n      '<svg viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\"><path d=\"M9 5H7c-1.105 0-2 .895-2 2v3c0 1.105-.895 2-2 2 1.105 0 2 .895 2 2v3c0 1.105.895 2 2 2h2\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M15 5h2c1.105 0 2 .895 2 2v3c0 1.105.895 2 2 2-1.105 0-2 .895-2 2v3c0 1.105-.895 2-2 2h-2\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></svg>',\n    array:\n      '<svg viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\"><path d=\"M5 7h14M5 12h14M5 17h14\" stroke-width=\"2\" stroke-linecap=\"round\"/></svg>',\n    string:\n      '<svg viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\"><path d=\"M9 7H7l-2 5 2 5h2\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M15 7h2l2 5-2 5h-2\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></svg>',\n    number:\n      '<svg viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\"><path d=\"M10 4v16M14 4v16M4 10h16M4 14h16\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></svg>',\n    boolean:\n      '<svg viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\"><rect x=\"3\" y=\"7\" width=\"18\" height=\"10\" rx=\"5\" ry=\"5\" stroke-width=\"2\"/><circle cx=\"9\" cy=\"12\" r=\"3.5\" stroke-width=\"2\"/></svg>',\n    null:\n      '<svg viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\"><circle cx=\"12\" cy=\"12\" r=\"6\" stroke-width=\"2\"/><path d=\"M8.5 8.5 15.5 15.5\" stroke-width=\"2\" stroke-linecap=\"round\"/></svg>',\n    link:\n      '<svg viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\"><path d=\"M10 13a5 5 0 0 0 7.54.54l1.92-1.92a5 5 0 0 0-7.07-7.07l-1.09 1.09\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M14 11a5 5 0 0 0-7.54-.54l-1.92 1.92a5 5 0 0 0 7.07 7.07l1.09-1.09\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></svg>',\n    unknown:\n      '<svg viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\"><circle cx=\"12\" cy=\"17\" r=\"1.5\" stroke-width=\"2\"/><path d=\"M12 13v-1.5a3.5 3.5 0 1 0-3.5-3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></svg>'\n  };\n\n  const panState = { x: 0, y: 0, scale: 1 };\n  let minScaleLimit = MANUAL_MIN_SCALE;\n\n  if (viewSelect instanceof HTMLSelectElement) {\n    viewSelect.value = viewMode;\n    viewSelect.addEventListener('change', (event) => {\n      const next = event.target.value === 'tree' ? 'tree' : 'graph';\n      setViewMode(next);\n    });\n  }\n\n  if (searchInput instanceof HTMLInputElement) {\n    searchInput.addEventListener('input', (event) => {\n      const value = event.target.value.trim();\n      performSearch(value);\n    });\n  }\n\n  if (chatToggle instanceof HTMLButtonElement) {\n    chatToggle.addEventListener('click', () => {\n      if (chatPanelVisible) {\n        toggleChatPanel(false);\n        return;\n      }\n\n      toggleChatPanel(true);\n      if (hasAiKey) {\n        showChatStatus('');\n        return;\n      }\n\n      awaitingChatKey = true;\n      showChatStatus(getMissingKeyMessage());\n      vscode.postMessage({ type: 'chat:ensureKey' });\n    });\n  }\n\n  if (chatClose instanceof HTMLButtonElement) {\n    chatClose.addEventListener('click', () => toggleChatPanel(false));\n  }\n\n  if (chatReset instanceof HTMLButtonElement) {\n    chatReset.addEventListener('click', () => {\n      vscode.postMessage({ type: 'chat:reset' });\n      clearChatMessages();\n    });\n  }\n\n  if (chatForm instanceof HTMLFormElement && chatInput instanceof HTMLTextAreaElement) {\n    const submitChatInput = () => {\n      const value = chatInput.value.trim();\n      if (!value) {\n        return;\n      }\n\n      if (!hasAiKey) {\n        awaitingChatKey = true;\n        showChatStatus(getMissingKeyMessage());\n        vscode.postMessage({ type: 'chat:ensureKey' });\n        return;\n      }\n\n      vscode.postMessage({ type: 'chat:send', payload: { text: value } });\n      chatInput.value = '';\n      showChatStatus('Waiting for response…');\n    };\n\n    chatForm.addEventListener('submit', (event) => {\n      event.preventDefault();\n      submitChatInput();\n    });\n\n    chatInput.addEventListener('keydown', (event) => {\n      if (event.key === 'Enter' && !event.shiftKey) {\n        event.preventDefault();\n        submitChatInput();\n      }\n    });\n  }\n\n  if (chatModelSelect instanceof HTMLSelectElement) {\n    chatModelSelect.addEventListener('change', (event) => {\n      const value = event.target.value;\n      if (!value) {\n        return;\n      }\n      vscode.postMessage({ type: 'chat:setModel', payload: { modelId: value } });\n    });\n  }\n\n  if (\n    selectionLineForm instanceof HTMLFormElement &&\n    selectionStartInput instanceof HTMLInputElement &&\n    selectionEndInput instanceof HTMLInputElement\n  ) {\n    selectionLineForm.addEventListener('submit', (event) => {\n      event.preventDefault();\n      const startValue = parseLineInput(selectionStartInput.value);\n      const endValue = parseLineInput(selectionEndInput.value);\n      if (typeof startValue !== 'number' || typeof endValue !== 'number') {\n        return;\n      }\n      const normalized = normalizeLineRange(startValue, endValue);\n      selectionActive = true;\n      selectionLineRange = normalized;\n      updateSelectionInputs();\n      vscode.postMessage({ type: 'selection:applyLines', payload: { startLine: normalized.start, endLine: normalized.end } });\n    });\n  }\n\n  if (selectionClearButton instanceof HTMLButtonElement) {\n    selectionClearButton.addEventListener('click', () => {\n      if (selectionStartInput instanceof HTMLInputElement) {\n        selectionStartInput.value = '';\n      }\n      if (selectionEndInput instanceof HTMLInputElement) {\n        selectionEndInput.value = '';\n      }\n    selectionLineRange = {};\n    selectionActive = false;\n    updateSelectionInputs();\n    vscode.postMessage({ type: 'selection:clear' });\n  });\n}\n\n  if (controlDockToggle instanceof HTMLButtonElement) {\n    controlDockToggle.addEventListener('click', () => {\n      setControlsCollapsed(!controlsCollapsed);\n    });\n  }\n\n  setControlsCollapsed(controlsCollapsed, { persist: false });\n\n  container.addEventListener('click', handleContainerClick);\n  container.addEventListener('keydown', handleKeydown);\n\n  window.addEventListener('message', (event) => {\n    const { type, payload } = event.data || {};\n    if (type === 'render') {\n      renderVisualizer(payload);\n      return;\n    }\n\n    if (type === 'invalid') {\n      renderInvalidState(payload);\n      return;\n    }\n\n    if (type === 'chat:history') {\n      renderChatHistory(payload);\n      return;\n    }\n\n    if (type === 'chat:userMessage') {\n      ensureChatPanel();\n      setChatMessage(payload?.id, 'user', payload?.text ?? '');\n      return;\n    }\n\n    if (type === 'chat:assistantStart') {\n      ensureChatPanel();\n      setChatMessage(payload?.id, 'assistant', '', { pending: true });\n      showChatStatus('AI is thinking...');\n      return;\n    }\n\n    if (type === 'chat:assistantDelta') {\n      appendChatDelta(payload?.id, payload?.text ?? '');\n      return;\n    }\n\n    if (type === 'chat:assistantComplete') {\n      finalizeAssistantMessage(payload?.id, payload?.text ?? '', payload?.snippet);\n      return;\n    }\n\n    if (type === 'chat:error') {\n      showChatStatus(payload ?? 'AI error');\n      return;\n    }\n\n    if (type === 'chat:status') {\n      showChatStatus(payload?.state === 'thinking' ? 'AI is thinking...' : '');\n      return;\n    }\n\n    if (type === 'chat:needsApiKey') {\n      showChatStatus(`${getMissingKeyMessage()} Use the command palette to configure it.`);\n    }\n\n    if (type === 'chat:ensureKeyResult') {\n      hasAiKey = Boolean(payload?.ready);\n      if (hasAiKey) {\n        awaitingChatKey = false;\n        showChatStatus('');\n      } else if (awaitingChatKey) {\n        showChatStatus(`${getMissingKeyMessage()} Run “JSON Atlas: Set AI API Key”.`);\n      }\n      return;\n    }\n\n    if (type === 'chat:aiStatus') {\n      if (typeof payload?.provider === 'string') {\n        activeModelProvider = payload.provider;\n      }\n      hasAiKey = Boolean(payload?.hasKey);\n      if (chatPanelVisible && !hasAiKey) {\n        showChatStatus(getMissingKeyMessage());\n      } else if (chatPanelVisible) {\n        showChatStatus('');\n      }\n      return;\n    }\n\n    if (type === 'chat:modelOptions') {\n      updateModelSelect(payload);\n      return;\n    }\n\n    if (type === 'selection:update') {\n      applySelectionInfo(payload);\n      return;\n    }\n\n    if (type === 'visualizer:focusPath') {\n      const path = typeof payload === 'string' ? payload : undefined;\n      if (!path) {\n        return;\n      }\n      pendingSearchFocusId = path;\n      if (viewMode !== 'graph') {\n        setViewMode('graph');\n        return;\n      }\n      requestAnimationFrame(() => {\n        if (nodeElements.has(path)) {\n          focusGraphNode(path);\n          pendingSearchFocusId = undefined;\n        }\n      });\n      return;\n    }\n  });\n\n  vscode.postMessage({ type: 'ready' });\n\n  function persistState(options = { savePositions: true }) {\n    if (options.savePositions !== false && currentDocumentId) {\n      nodePositionStore[currentDocumentId] = serializePositions(nodePositions);\n    }\n\n    persistedState = {\n      ...persistedState,\n      viewMode,\n      nodePositions: nodePositionStore,\n      controlsCollapsed\n    };\n    if (typeof vscode.setState === 'function') {\n      vscode.setState(persistedState);\n    }\n  }\n\n  function switchDocument(documentId) {\n    if (currentDocumentId === documentId) {\n      return;\n    }\n\n    if (currentDocumentId) {\n      persistState();\n      collapsedPathStore.set(currentDocumentId, new Set(collapsedPaths));\n      depthExpandedPathStore.set(currentDocumentId, new Set(depthExpandedPaths));\n    }\n\n    currentDocumentId = documentId;\n    const stored = nodePositionStore[documentId];\n    nodePositions = new Map(stored ? Object.entries(stored) : []);\n    const collapsed = collapsedPathStore.get(documentId);\n    collapsedPaths = new Set(collapsed instanceof Set ? collapsed : []);\n    const expanded = depthExpandedPathStore.get(documentId);\n    depthExpandedPaths = new Set(expanded instanceof Set ? expanded : []);\n    needsInitialGraphFocus = true;\n  }\n\n  function pruneNodePositions(validIds) {\n    let changed = false;\n    for (const id of Array.from(nodePositions.keys())) {\n      if (!validIds.has(id)) {\n        nodePositions.delete(id);\n        changed = true;\n      }\n    }\n\n    if (changed) {\n      persistState();\n    }\n  }\n\n  function handleContainerClick(event) {\n    const target = event.target;\n    if (!(target instanceof HTMLElement)) {\n      return;\n    }\n\n    const editValueTarget = target.closest('[data-action=\"edit-value\"]');\n    if (editValueTarget instanceof HTMLElement) {\n      const path = editValueTarget.getAttribute('data-path');\n      const literal = editValueTarget.getAttribute('data-literal');\n      const kind = editValueTarget.getAttribute('data-kind') ?? 'string';\n      const href = editValueTarget.getAttribute('data-href');\n      if (!path || !literal) {\n        return;\n      }\n\n      if (href && (event.metaKey || event.ctrlKey)) {\n        event.preventDefault();\n        vscode.postMessage({ type: 'openLink', payload: href });\n        return;\n      }\n\n      event.preventDefault();\n      event.stopPropagation();\n      requestEditValue(path, literal, kind);\n      return;\n    }\n\n    const link = target.closest('[data-open-link=\"true\"]');\n    const href = link instanceof HTMLAnchorElement ? link.href : link?.getAttribute('data-href');\n    if (href) {\n      event.preventDefault();\n      vscode.postMessage({ type: 'openLink', payload: href });\n      return;\n    }\n\n    const renameTarget = target.closest('[data-action=\"rename\"]');\n    if (renameTarget instanceof HTMLElement) {\n      const path = renameTarget.getAttribute('data-path');\n      const currentName = renameTarget.getAttribute('data-key') ?? '';\n      if (!path) {\n        return;\n      }\n      event.preventDefault();\n      event.stopPropagation();\n      requestRename(path, currentName);\n      return;\n    }\n\n    const toggle = target.closest('button[data-action=\"toggle\"]');\n    if (toggle) {\n      const path = toggle.getAttribute('data-path');\n      if (!path) {\n        return;\n      }\n\n      event.preventDefault();\n      togglePath(path);\n    }\n  }\n\n  function handleKeydown(event) {\n    const target = event.target;\n    if (!(target instanceof HTMLElement)) {\n      return;\n    }\n\n    if (\n      (event.key === 'Enter' || event.key === ' ') &&\n      target.hasAttribute('data-action') &&\n      target.getAttribute('data-action') === 'rename'\n    ) {\n      const path = target.getAttribute('data-path');\n      const currentName = target.getAttribute('data-key') ?? '';\n      if (!path) {\n        return;\n      }\n      event.preventDefault();\n      event.stopPropagation();\n      requestRename(path, currentName);\n      return;\n    }\n\n    if (\n      (event.key === 'Enter' || event.key === ' ') &&\n      target.hasAttribute('data-action') &&\n      target.getAttribute('data-action') === 'edit-value'\n    ) {\n      const path = target.getAttribute('data-path');\n      const literal = target.getAttribute('data-literal');\n      const kind = target.getAttribute('data-kind') ?? 'string';\n      if (!path || !literal) {\n        return;\n      }\n      event.preventDefault();\n      event.stopPropagation();\n      requestEditValue(path, literal, kind);\n    }\n  }\n\n  function togglePath(path) {\n    if (!path) {\n      return;\n    }\n\n    if (isAutoCollapsedPath(path)) {\n      depthExpandedPaths.add(path);\n      rerenderFromState(false);\n      focusPath(path);\n      return;\n    }\n\n    if (collapsedPaths.has(path)) {\n      collapsedPaths.delete(path);\n      depthExpandedPaths.add(path);\n    } else {\n      collapsedPaths.add(path);\n      depthExpandedPaths.delete(path);\n    }\n\n    rerenderFromState(false);\n    focusPath(path);\n  }\n\n  function rememberPathDepth(pathKey, depth) {\n    pathDepths.set(pathKey, depth);\n  }\n\n  function getActiveDepthLimit() {\n    if (typeof graphMaxDepth === 'number' && Number.isFinite(graphMaxDepth) && graphMaxDepth > 0) {\n      return graphMaxDepth;\n    }\n    return undefined;\n  }\n\n  function shouldCollapseByDepth(pathKey, depth) {\n    const limit = getActiveDepthLimit();\n    if (typeof limit !== 'number') {\n      return false;\n    }\n    return depth >= limit && !depthExpandedPaths.has(pathKey);\n  }\n\n  function isAutoCollapsedPath(pathKey) {\n    const depth = pathDepths.get(pathKey);\n    if (typeof depth !== 'number') {\n      return false;\n    }\n    return shouldCollapseByDepth(pathKey, depth);\n  }\n\n  function requestRename(pathKey, currentName) {\n    vscode.postMessage({\n      type: 'requestRename',\n      payload: { path: pathKey, currentName }\n    });\n  }\n\n  function requestEditValue(pathKey, literal, kind) {\n    vscode.postMessage({\n      type: 'requestEditValue',\n      payload: { path: pathKey, literal, kind }\n    });\n  }\n\n  function initViewport() {\n    viewport = document.createElement('div');\n    viewport.className = 'visualizer-viewport';\n\n    canvas = document.createElement('div');\n    canvas.className = 'visualizer-canvas';\n\n    linksLayer = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    linksLayer.classList.add('visualizer-links');\n    linksLayer.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n\n    nodesLayer = document.createElement('div');\n    nodesLayer.className = 'visualizer-nodes';\n\n    canvas.appendChild(linksLayer);\n    canvas.appendChild(nodesLayer);\n    viewport.appendChild(canvas);\n    graphRoot.appendChild(viewport);\n\n    setupPanAndZoom();\n  }\n\n  function setupPanAndZoom() {\n    viewport.addEventListener('pointerdown', (event) => {\n      if (event.button !== 0) {\n        return;\n      }\n\n      if (event.target instanceof HTMLElement && event.target.closest('.visualizer-node')) {\n        return;\n      }\n\n      isPanning = true;\n      hasUserMovedView = true;\n      panPointerId = event.pointerId;\n      panStart = { x: event.clientX, y: event.clientY };\n      panOrigin = { x: panState.x, y: panState.y };\n      viewport.setPointerCapture(panPointerId);\n      viewport.classList.add('is-panning');\n    });\n\n    viewport.addEventListener('pointermove', (event) => {\n      if (!isPanning || event.pointerId !== panPointerId) {\n        return;\n      }\n\n      const deltaX = event.clientX - panStart.x;\n      const deltaY = event.clientY - panStart.y;\n      panState.x = panOrigin.x + deltaX;\n      panState.y = panOrigin.y + deltaY;\n      applyPan();\n    });\n\n    const endPan = (event) => {\n      if (!isPanning || (event.pointerId !== undefined && event.pointerId !== panPointerId)) {\n        return;\n      }\n\n      isPanning = false;\n      const pointerToRelease = panPointerId;\n      panPointerId = null;\n      viewport.classList.remove('is-panning');\n      if (typeof pointerToRelease === 'number') {\n        try {\n          viewport.releasePointerCapture(pointerToRelease);\n        } catch {\n          // pointer may already be released; ignore\n        }\n      }\n    };\n\n    viewport.addEventListener('pointerup', endPan);\n    viewport.addEventListener('pointercancel', endPan);\n\n    viewport.addEventListener(\n      'wheel',\n      (event) => {\n        event.preventDefault();\n        const direction = event.deltaY < 0 ? 1 : -1;\n        const factor = direction > 0 ? 1.1 : 0.9;\n        const nextScale = clamp(panState.scale * factor, minScaleLimit, MAX_SCALE);\n        if (nextScale === panState.scale) {\n          return;\n        }\n\n        hasUserMovedView = true;\n        const rect = viewport.getBoundingClientRect();\n        const offsetX = event.clientX - rect.left;\n        const offsetY = event.clientY - rect.top;\n        const scaleRatio = nextScale / panState.scale;\n        panState.x = offsetX - (offsetX - panState.x) * scaleRatio;\n        panState.y = offsetY - (offsetY - panState.y) * scaleRatio;\n        panState.scale = nextScale;\n        applyPan();\n      },\n      { passive: false }\n    );\n\n    viewport.addEventListener('dblclick', () => {\n      resetPan(true);\n    });\n  }\n\n  function applyPan() {\n    if (!canvas) {\n      return;\n    }\n    canvas.style.transform = `translate(${panState.x}px, ${panState.y}px) scale(${panState.scale})`;\n  }\n\n  function resetPan(force, scaleOverride) {\n    if (!canvas || (!force && hasUserMovedView)) {\n      return;\n    }\n\n    const host = graphRoot;\n    const viewportWidth = host.clientWidth || 1;\n    const viewportHeight = host.clientHeight || 1;\n    const canvasRect = canvas.getBoundingClientRect();\n    const canvasWidth = Number.parseFloat(canvas.style.width) || canvasRect.width || viewportWidth;\n    const canvasHeight = Number.parseFloat(canvas.style.height) || canvasRect.height || viewportHeight;\n\n    const targetScale = typeof scaleOverride === 'number' ? scaleOverride : graphInitialScale;\n    const normalizedScale = typeof targetScale === 'number' ? targetScale : 1;\n    panState.scale = clamp(normalizedScale, minScaleLimit, MAX_SCALE);\n    panState.x = (viewportWidth - canvasWidth) / 2;\n    panState.y = Math.min(32, (viewportHeight - canvasHeight) / 2);\n    applyPan();\n  }\n\n  function updateMinScaleLimit(initialScale) {\n    if (graphAutoScale && typeof initialScale === 'number' && initialScale < MANUAL_MIN_SCALE) {\n      minScaleLimit = clamp(initialScale, AUTO_MIN_SCALE, MANUAL_MIN_SCALE);\n      return;\n    }\n    minScaleLimit = MANUAL_MIN_SCALE;\n  }\n\n  function rerenderFromState(force) {\n    if (typeof currentPayload === 'undefined') {\n      return;\n    }\n\n    if (force && viewMode === 'graph') {\n      resetPan(true, graphInitialScale);\n      hasUserMovedView = false;\n    }\n\n    renderData(currentPayload);\n  }\n\n  function setViewMode(mode) {\n    const normalized = mode === 'tree' ? 'tree' : 'graph';\n    if (normalized === viewMode) {\n      return;\n    }\n\n    viewMode = normalized;\n    hasPersistedViewPreference = true;\n    if (viewSelect instanceof HTMLSelectElement) {\n      viewSelect.value = normalized;\n    }\n\n    persistState();\n    if (currentPayload) {\n      renderData(currentPayload);\n    }\n  }\n\n  function renderVisualizer(payload) {\n    const data = payload && typeof payload === 'object' && 'data' in payload ? payload.data : payload;\n    const documentId =\n      payload && typeof payload === 'object' && typeof payload.documentId === 'string'\n        ? payload.documentId\n        : undefined;\n    const defaultViewMode =\n      payload && typeof payload === 'object' && typeof payload.defaultViewMode === 'string'\n        ? payload.defaultViewMode\n        : undefined;\n\n    const initialSelectionInfo =\n      payload && typeof payload === 'object' && 'selectionInfo' in payload ? payload.selectionInfo : undefined;\n    applySelectionInfo(initialSelectionInfo);\n\n    if (payload && typeof payload === 'object') {\n      if (payload.focusRoot) {\n        if (viewMode !== 'graph') {\n          setViewMode('graph');\n        }\n        pendingSearchFocusId = ROOT_PATH;\n      }\n      if (payload.resetLayout && currentDocumentId) {\n        nodePositions = new Map();\n        nodePositionStore[currentDocumentId] = {};\n      }\n      if (payload.resetView || payload.focusRoot) {\n        needsInitialGraphFocus = true;\n        hasUserMovedView = false;\n        pendingSearchFocusId = undefined;\n        currentSearchMatch = undefined;\n      }\n      if (typeof payload.graphAutoScale === 'boolean') {\n        graphAutoScale = payload.graphAutoScale;\n      }\n      if (typeof payload.graphInitialScale === 'number') {\n        manualGraphScale = clampScale(payload.graphInitialScale);\n      }\n      if (typeof payload.graphMaxDepth === 'number') {\n        graphMaxDepth = Number.isFinite(payload.graphMaxDepth) && payload.graphMaxDepth > 0 ? Math.floor(payload.graphMaxDepth) : undefined;\n      } else if (payload.graphMaxDepth === null) {\n        graphMaxDepth = undefined;\n      }\n    }\n\n    if (documentId) {\n      switchDocument(documentId);\n    } else if (!currentDocumentId) {\n      currentDocumentId = 'default';\n      nodePositions = new Map();\n      needsInitialGraphFocus = true;\n    }\n\n    if (defaultViewMode) {\n      const normalized = defaultViewMode === 'tree' ? 'tree' : 'graph';\n      preferredDefaultViewMode = normalized;\n      if (!hasPersistedViewPreference && viewMode !== normalized) {\n        viewMode = normalized;\n        if (viewSelect instanceof HTMLSelectElement) {\n          viewSelect.value = normalized;\n        }\n      }\n    }\n\n    if (typeof data === 'undefined') {\n      return;\n    }\n\n    currentPayload = data;\n    renderData(data);\n  }\n\n  function renderData(data) {\n    hideStatus();\n    pathDepths.clear();\n    const graphData = buildGraph(data);\n    updateSearchIndex(graphData.nodes);\n\n    if (viewMode === 'tree') {\n      renderTreeView(data);\n    } else {\n      renderGraph(graphData);\n    }\n  }\n\n  function renderGraph(graph) {\n    graphRoot.removeAttribute('hidden');\n    treeRoot.setAttribute('hidden', 'true');\n\n    if (!viewport) {\n      initViewport();\n    }\n\n    nodesLayer.innerHTML = '';\n    linksLayer.innerHTML = '';\n    nodeElements.clear();\n\n    canvas.style.width = `${graph.size.width}px`;\n    canvas.style.height = `${graph.size.height}px`;\n    linksLayer.setAttribute('width', String(graph.size.width));\n    linksLayer.setAttribute('height', String(graph.size.height));\n    linksLayer.setAttribute('viewBox', `0 0 ${graph.size.width} ${graph.size.height}`);\n\n    graph.nodes.forEach((node) => {\n      const element = createGraphNodeElement(node);\n      nodesLayer.appendChild(element);\n      nodeElements.set(node.id, { node, element });\n    });\n\n    currentEdges = graph.edges;\n    pruneNodePositions(new Set(graph.nodes.map((node) => node.id)));\n    drawEdges(currentEdges);\n\n    const targetScale = graphAutoScale ? computeAutoScale(graph.size, graph.nodes.length) : clampScale(manualGraphScale);\n    graphInitialScale = targetScale;\n    updateMinScaleLimit(graphInitialScale);\n\n    if (hasUserMovedView) {\n      resetPan(false);\n    } else {\n      resetPan(true, graphInitialScale);\n      hasUserMovedView = false;\n    }\n\n    applyPan();\n    applySearchHighlight();\n    if (pendingSearchFocusId) {\n      focusGraphNode(pendingSearchFocusId);\n      pendingSearchFocusId = undefined;\n      needsInitialGraphFocus = false;\n    } else if (currentSearchMatch) {\n      highlightGraphNode(currentSearchMatch);\n      needsInitialGraphFocus = false;\n    } else if (needsInitialGraphFocus) {\n      focusGraphNode(ROOT_PATH);\n      needsInitialGraphFocus = false;\n    }\n  }\n\n  function renderTreeView(payload) {\n    treeRoot.removeAttribute('hidden');\n    graphRoot.setAttribute('hidden', 'true');\n\n    treeRoot.innerHTML = '';\n    const tree = document.createElement('ul');\n    tree.className = 'visualizer-tree';\n    tree.setAttribute('role', 'tree');\n    tree.appendChild(buildTreeBranch('JSON', payload, [], 0));\n    treeRoot.appendChild(tree);\n  }\n\n  function buildTreeBranch(key, value, path, depth) {\n    const pathKey = serializePath(path);\n    const entries = getChildEntries(value);\n    const hasChildren = entries.length > 0;\n    rememberPathDepth(pathKey, depth);\n    const depthLimited = shouldCollapseByDepth(pathKey, depth);\n    const isCollapsed = hasChildren && (collapsedPaths.has(pathKey) || depthLimited);\n\n    const listItem = document.createElement('li');\n    listItem.className = 'tree-branch';\n    listItem.dataset.depth = String(depth);\n    if (hasChildren) {\n      listItem.setAttribute('aria-expanded', String(!isCollapsed));\n    }\n    if (isCollapsed) {\n      listItem.classList.add('is-collapsed');\n    }\n\n    const control = document.createElement(hasChildren ? 'button' : 'div');\n    control.className = `tree-node ${hasChildren ? 'tree-node--branch' : 'tree-node--leaf'}`;\n    control.dataset.path = pathKey;\n    control.dataset.depth = String(depth);\n\n    if (hasChildren) {\n      control.type = 'button';\n      control.dataset.action = 'toggle';\n      control.setAttribute('aria-expanded', String(!isCollapsed));\n    }\n\n    const chevron = document.createElement('span');\n    chevron.className = 'tree-node__chevron';\n    chevron.setAttribute('aria-hidden', 'true');\n    control.appendChild(chevron);\n\n    const keySpan = document.createElement('span');\n    const canRename = typeof path[path.length - 1] === 'string';\n    keySpan.className = `tree-node__key${canRename ? ' tree-node__key--action' : ''}`;\n    keySpan.textContent = String(key);\n    if (canRename) {\n      keySpan.dataset.action = 'rename';\n      keySpan.dataset.path = pathKey;\n      keySpan.dataset.key = String(key);\n      keySpan.setAttribute('role', 'button');\n      keySpan.setAttribute('tabindex', '0');\n      keySpan.title = 'Rename key';\n    }\n    control.appendChild(keySpan);\n\n    const connector = document.createElement('span');\n    connector.className = 'tree-node__connector';\n    connector.setAttribute('aria-hidden', 'true');\n    control.appendChild(connector);\n\n    const descriptor = describeValue(value);\n    const valueElement = createValueElement(descriptor, 'tree-node__value', {\n      path: pathKey,\n      editable: canEditValueDescriptor(descriptor)\n    });\n    control.appendChild(valueElement);\n\n    listItem.appendChild(control);\n\n    if (hasChildren && !isCollapsed) {\n      const childList = document.createElement('ul');\n      childList.className = 'visualizer-tree-children';\n      childList.setAttribute('role', 'group');\n      entries.forEach(([childKey, childValue]) => {\n        const childPath = path.concat([childKey]);\n        const childLabel = formatChildKey(key, childKey, value);\n        childList.appendChild(buildTreeBranch(childLabel, childValue, childPath, depth + 1));\n      });\n      listItem.appendChild(childList);\n    }\n\n    return listItem;\n  }\n\n  function renderInvalidState(message) {\n    selectionActive = false;\n    selectionLabel = '';\n    updateSelectionIndicator();\n    graphRoot.setAttribute('hidden', 'true');\n    treeRoot.setAttribute('hidden', 'true');\n    status.textContent = message || 'The document contains syntax errors.';\n    status.removeAttribute('hidden');\n  }\n\n  function hideStatus() {\n    status.setAttribute('hidden', 'true');\n  }\n\n  function buildGraph(payload) {\n    const nodes = [];\n    const edges = [];\n    let maxDepth = 0;\n    let nextRow = 0;\n\n    const traverse = (key, value, path, depth, parentId) => {\n      const pathKey = serializePath(path);\n      rememberPathDepth(pathKey, depth);\n      const children = getChildEntries(value);\n      const hasChildren = children.length > 0;\n      const depthLimited = shouldCollapseByDepth(pathKey, depth);\n      const isCollapsed = hasChildren && (collapsedPaths.has(pathKey) || depthLimited);\n\n      const lastSegment = path[path.length - 1];\n      const node = {\n        id: pathKey,\n        key: String(key),\n        descriptor: describeValue(value),\n        depth,\n        x: depth * NODE_GAP_X,\n        y: 0,\n        hasChildren,\n        isCollapsed,\n        canRename: typeof lastSegment === 'string'\n      };\n\n      nodes.push(node);\n      maxDepth = Math.max(maxDepth, depth);\n\n      if (parentId) {\n        edges.push({ from: parentId, to: pathKey });\n      }\n\n      if (!hasChildren || isCollapsed) {\n        node.y = nextRow * NODE_GAP_Y;\n        nextRow += 1;\n        return node.y;\n      }\n\n      const childPositions = children.map(([childKey, childValue]) =>\n        traverse(formatChildKey(key, childKey, value), childValue, path.concat([childKey]), depth + 1, pathKey)\n      );\n\n      if (childPositions.length) {\n        const top = childPositions[0];\n        const bottom = childPositions[childPositions.length - 1];\n        node.y = top + (bottom - top) / 2;\n      } else {\n        node.y = nextRow * NODE_GAP_Y;\n        nextRow += 1;\n      }\n\n      return node.y;\n    };\n\n    traverse('JSON', payload, [], 0, null);\n\n    const width = (maxDepth + 1) * NODE_GAP_X + CANVAS_PADDING * 2;\n    const height = Math.max(nextRow * NODE_GAP_Y, NODE_GAP_Y) + CANVAS_PADDING * 2;\n\n    nodes.forEach((node) => {\n      node.x += CANVAS_PADDING;\n      node.y += CANVAS_PADDING;\n      const custom = nodePositions.get(node.id);\n      if (custom) {\n        node.x = custom.x;\n        node.y = custom.y;\n      }\n    });\n\n    return {\n      nodes,\n      edges,\n      size: { width, height }\n    };\n  }\n\n  function createGraphNodeElement(node) {\n    const element = document.createElement(node.hasChildren ? 'button' : 'div');\n    element.className = `visualizer-node ${node.hasChildren ? 'visualizer-node--branch' : 'visualizer-node--leaf'}`;\n    element.style.left = `${node.x}px`;\n    element.style.top = `${node.y}px`;\n    element.dataset.path = node.id;\n\n    if (node.hasChildren) {\n      element.type = 'button';\n      element.dataset.action = 'toggle';\n      element.setAttribute('aria-expanded', String(!node.isCollapsed));\n      if (node.isCollapsed) {\n        element.classList.add('is-collapsed');\n      }\n    }\n\n    const chevron = document.createElement('span');\n    chevron.className = 'visualizer-node__chevron';\n    chevron.setAttribute('aria-hidden', 'true');\n    element.appendChild(chevron);\n\n    const key = document.createElement('span');\n    key.className = `visualizer-node__key${node.canRename ? ' visualizer-node__key--action' : ''}`;\n    key.textContent = node.key;\n    if (node.canRename) {\n      key.dataset.action = 'rename';\n      key.dataset.path = node.id;\n      key.dataset.key = node.key;\n      key.setAttribute('role', 'button');\n      key.setAttribute('tabindex', '0');\n      key.title = 'Rename key';\n    }\n    element.appendChild(key);\n\n    const connector = document.createElement('span');\n    connector.className = 'visualizer-node__connector';\n    connector.setAttribute('aria-hidden', 'true');\n    element.appendChild(connector);\n\n    const valueElement = createValueElement(node.descriptor, 'visualizer-node__value', {\n      path: node.id,\n      editable: !node.hasChildren && canEditValueDescriptor(node.descriptor)\n    });\n    element.appendChild(valueElement);\n\n    enableNodeDragging(element, node);\n\n    return element;\n  }\n\n  function enableNodeDragging(element, node) {\n    element.addEventListener('pointerdown', (event) => {\n      if (!shouldStartNodeDrag(event)) {\n        return;\n      }\n\n      activeNodeDrag = {\n        id: node.id,\n        pointerId: event.pointerId,\n        startX: event.clientX,\n        startY: event.clientY,\n        originX: node.x,\n        originY: node.y,\n        moved: false\n      };\n\n      element.setPointerCapture(event.pointerId);\n      event.preventDefault();\n    });\n\n    element.addEventListener('pointermove', (event) => {\n      if (!activeNodeDrag || activeNodeDrag.id !== node.id || event.pointerId !== activeNodeDrag.pointerId) {\n        return;\n      }\n\n      const deltaX = (event.clientX - activeNodeDrag.startX) / panState.scale;\n      const deltaY = (event.clientY - activeNodeDrag.startY) / panState.scale;\n      const newX = activeNodeDrag.originX + deltaX;\n      const newY = activeNodeDrag.originY + deltaY;\n      updateNodePosition(node.id, newX, newY);\n      activeNodeDrag.moved = true;\n      event.preventDefault();\n    });\n\n    const endDrag = (event) => finishNodeDrag(event, node, element);\n    element.addEventListener('pointerup', endDrag);\n    element.addEventListener('pointercancel', endDrag);\n\n    element.addEventListener('click', (event) => {\n      if (element.dataset.dragging === 'true') {\n        event.preventDefault();\n        event.stopPropagation();\n        element.dataset.dragging = '';\n      }\n    });\n  }\n\n  function drawEdges(edges) {\n    linksLayer.innerHTML = '';\n\n    edges.forEach((edge) => {\n      const parent = nodeElements.get(edge.from);\n      const child = nodeElements.get(edge.to);\n\n      if (!parent || !child) {\n        return;\n      }\n\n      const parentWidth = parent.element.offsetWidth;\n      const parentHeight = parent.element.offsetHeight;\n      const childHeight = child.element.offsetHeight;\n\n      const startX = parent.node.x + parentWidth;\n      const startY = parent.node.y + parentHeight / 2;\n      const endX = child.node.x;\n      const endY = child.node.y + childHeight / 2;\n      const controlOffset = Math.max(32, (endX - startX) / 2);\n\n      const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n      path.setAttribute(\n        'd',\n        `M ${startX} ${startY} C ${startX + controlOffset} ${startY}, ${endX - controlOffset} ${endY}, ${endX} ${endY}`\n      );\n      path.setAttribute('class', 'visualizer-link');\n      linksLayer.appendChild(path);\n    });\n  }\n\n  function updateNodePosition(nodeId, x, y) {\n    const entry = nodeElements.get(nodeId);\n    if (!entry) {\n      return;\n    }\n\n    entry.node.x = x;\n    entry.node.y = y;\n    entry.element.style.left = `${x}px`;\n    entry.element.style.top = `${y}px`;\n    drawEdges(currentEdges);\n  }\n\n  function finishNodeDrag(event, node, element) {\n    if (\n      !activeNodeDrag ||\n      activeNodeDrag.id !== node.id ||\n      (event.pointerId !== undefined && event.pointerId !== activeNodeDrag.pointerId)\n    ) {\n      return;\n    }\n\n    try {\n      element.releasePointerCapture(activeNodeDrag.pointerId);\n    } catch {\n      // no-op\n    }\n\n    const moved = activeNodeDrag.moved;\n    activeNodeDrag = undefined;\n\n    if (moved) {\n      element.dataset.dragging = 'true';\n      nodePositions.set(node.id, { x: node.x, y: node.y });\n      persistState();\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  }\n\n  function getChildEntries(value) {\n    if (Array.isArray(value)) {\n      return value.map((child, index) => [index, child]);\n    }\n\n    if (isObject(value)) {\n      return Object.entries(value);\n    }\n\n    return [];\n  }\n\n  function describeValue(value) {\n    if (value === null) {\n      return { label: 'null', kind: 'null', icon: ICON_TYPES.null, rawValue: null };\n    }\n\n    if (Array.isArray(value)) {\n      return { label: `[${value.length}]`, kind: 'array', icon: ICON_TYPES.array, rawValue: '[array]' };\n    }\n\n    switch (typeof value) {\n      case 'object':\n        return {\n          label: `{${Object.keys(value || {}).length}}`,\n          kind: 'object',\n          icon: ICON_TYPES.object,\n          rawValue: '[object]'\n        };\n      case 'string': {\n        const trimmed = value.trim();\n        if (isUrl(trimmed)) {\n          return {\n            label: truncate(trimmed, 42),\n            kind: 'link',\n            href: trimmed,\n            title: trimmed,\n            icon: ICON_TYPES.link,\n            rawValue: trimmed\n          };\n        }\n        return {\n          label: `\"${truncate(value)}\"`,\n          kind: 'string',\n          title: value,\n          icon: ICON_TYPES.string,\n          rawValue: value\n        };\n      }\n      case 'number':\n        return { label: String(value), kind: 'number', icon: ICON_TYPES.number, rawValue: value };\n      case 'boolean':\n        return { label: String(value), kind: 'boolean', icon: ICON_TYPES.boolean, rawValue: value };\n      default:\n        return { label: '', kind: 'unknown', icon: ICON_TYPES.unknown, rawValue: '' };\n    }\n  }\n\n  function canEditValueDescriptor(descriptor) {\n    if (!descriptor) {\n      return false;\n    }\n    return EDITABLE_VALUE_KINDS.has(descriptor.kind);\n  }\n\n  function serializeValueLiteral(rawValue) {\n    if (typeof rawValue === 'undefined') {\n      return 'null';\n    }\n\n    try {\n      return JSON.stringify(rawValue);\n    } catch {\n      return 'null';\n    }\n  }\n\n  function shouldStartNodeDrag(event) {\n    if (event.button !== 0) {\n      return false;\n    }\n\n    const target = event.target;\n    if (!(target instanceof HTMLElement)) {\n      return true;\n    }\n\n    if (target.closest('[data-action=\"rename\"]')) {\n      return false;\n    }\n\n    if (target.closest('[data-action=\"edit-value\"]')) {\n      return false;\n    }\n\n    if (target.closest('[data-open-link=\"true\"]')) {\n      return false;\n    }\n\n    return true;\n  }\n\n  function createValueElement(descriptor, className, options = {}) {\n    const element = document.createElement('span');\n    element.className = `${className} ${className}--${descriptor.kind}`;\n    const icon = createIconElement(descriptor.icon ?? ICON_TYPES.unknown);\n    element.appendChild(icon);\n\n    const textSpan = document.createElement('span');\n    textSpan.className = `${className}__text`;\n    textSpan.textContent = descriptor.label;\n    element.appendChild(textSpan);\n\n    if (descriptor.href) {\n      element.dataset.openLink = 'true';\n      element.setAttribute('data-href', descriptor.href);\n      if (descriptor.title) {\n        element.title = descriptor.title;\n      } else {\n        element.title = descriptor.href;\n      }\n    } else if (descriptor.title) {\n      element.title = descriptor.title;\n    }\n\n    if (options.editable && options.path) {\n      element.dataset.action = 'edit-value';\n      element.dataset.path = options.path;\n      element.dataset.kind = descriptor.kind === 'link' ? 'string' : descriptor.kind;\n      element.dataset.literal = serializeValueLiteral(descriptor.rawValue);\n      element.classList.add(`${className}--action`);\n      element.setAttribute('role', 'button');\n      element.setAttribute('tabindex', '0');\n      const baseTitle = element.title;\n      const editHint = descriptor.href\n        ? 'Click to edit value. Cmd/Ctrl+Click to open link.'\n        : 'Click to edit value.';\n      element.title = baseTitle ? `${baseTitle}\\n${editHint}` : editHint;\n    }\n\n    return element;\n  }\n\n  function createIconElement(type) {\n    const span = document.createElement('span');\n    span.className = 'value-icon';\n    const markup = ICON_SVGS[type] ?? ICON_SVGS.unknown;\n    span.innerHTML = markup;\n    const svg = span.querySelector('svg');\n    if (svg) {\n      svg.setAttribute('aria-hidden', 'true');\n      svg.setAttribute('focusable', 'false');\n    }\n    return span;\n  }\n\n  function truncate(value, limit = 28) {\n    if (value.length <= limit) {\n      return value;\n    }\n\n    return `${value.slice(0, limit - 1)}…`;\n  }\n\n  function isObject(value) {\n    return typeof value === 'object' && value !== null;\n  }\n\n  function isUrl(value) {\n    return /^https?:\\/\\/[^\\s]+$/i.test(value);\n  }\n\n  function serializePath(path) {\n    return JSON.stringify(path);\n  }\n\n  function computeAutoScale(graphSize, nodeCount) {\n    const heuristicScale = clampAutoScale(computeDensityScale(nodeCount));\n    const fitScale = computeFitScale(graphSize);\n    const candidate = typeof fitScale === 'number' ? Math.min(fitScale, heuristicScale) : heuristicScale;\n    return clampAutoScale(Math.max(candidate, AUTO_VISIBLE_MIN_SCALE));\n  }\n\n  function computeFitScale(graphSize) {\n    if (!graphSize) {\n      return undefined;\n    }\n\n    const viewportWidth = viewport?.clientWidth || graphRoot.clientWidth || window.innerWidth || 1;\n    const viewportHeight = viewport?.clientHeight || graphRoot.clientHeight || window.innerHeight || 1;\n    const width = graphSize?.width ?? 0;\n    const height = graphSize?.height ?? 0;\n    if (width <= 0 || height <= 0) {\n      return undefined;\n    }\n\n    const ratio = Math.min(viewportWidth / width, viewportHeight / height);\n    const padded = ratio * AUTO_FIT_PADDING;\n    if (!Number.isFinite(padded) || padded <= 0) {\n      return undefined;\n    }\n\n    return padded;\n  }\n\n  function computeDensityScale(nodeCount) {\n    if (nodeCount > 2000) {\n      return 0.35;\n    }\n    if (nodeCount > 1200) {\n      return 0.45;\n    }\n    if (nodeCount > 800) {\n      return 0.55;\n    }\n    if (nodeCount > 500) {\n      return 0.65;\n    }\n    if (nodeCount > 300) {\n      return 0.8;\n    }\n    return 1;\n  }\n\n  function clampAutoScale(value) {\n    const candidate = typeof value === 'number' && Number.isFinite(value) ? value : 1;\n    return clamp(candidate, AUTO_MIN_SCALE, AUTO_MAX_SCALE);\n  }\n\n  function clampScale(value) {\n    const candidate = typeof value === 'number' ? value : 1;\n    return clamp(candidate, MANUAL_MIN_SCALE, AUTO_MAX_SCALE);\n  }\n\n  function clamp(value, min, max) {\n    return Math.min(Math.max(value, min), max);\n  }\n\n  function formatChildKey(parentLabel, childKey, parentValue) {\n    if (!Array.isArray(parentValue)) {\n      return String(childKey);\n    }\n\n    const baseLabel = deriveArrayItemLabel(parentLabel);\n    const numeric = Number(childKey);\n    const suffix = Number.isInteger(numeric) ? numeric + 1 : String(childKey);\n    return `${baseLabel} ${suffix}`;\n  }\n\n  function deriveArrayItemLabel(parentLabel) {\n    if (!parentLabel || parentLabel === 'JSON') {\n      return 'Item';\n    }\n\n    const trimmed = parentLabel.trim();\n    if (!trimmed) {\n      return 'Item';\n    }\n\n    const lower = trimmed.toLowerCase();\n    if (lower.endsWith('ies')) {\n      return capitalize(lower.slice(0, -3) + 'y');\n    }\n\n    if (lower.endsWith('ses')) {\n      return capitalize(lower.slice(0, -2));\n    }\n\n    if (lower.endsWith('s')) {\n      return capitalize(lower.slice(0, -1));\n    }\n\n    return capitalize(lower);\n  }\n\n  function parseLineInput(value) {\n    if (typeof value !== 'string') {\n      return undefined;\n    }\n    const trimmed = value.trim();\n    if (!trimmed) {\n      return undefined;\n    }\n    const parsed = Number.parseInt(trimmed, 10);\n    if (!Number.isFinite(parsed) || parsed <= 0) {\n      return undefined;\n    }\n    return parsed;\n  }\n\n  function normalizeLineRange(start, end) {\n    if (start > end) {\n      return { start: end, end: start };\n    }\n    return { start, end };\n  }\n\n  function formatSelectionLabel(start, end) {\n    if (start === end) {\n      return `Line ${start}`;\n    }\n    return `Lines ${start}-${end}`;\n  }\n\n  function capitalize(value) {\n    if (!value) {\n      return '';\n    }\n\n    return value.charAt(0).toUpperCase() + value.slice(1);\n  }\n\n  function formatProviderName(provider) {\n    switch (provider) {\n      case 'openai':\n        return 'OpenAI';\n      case 'anthropic':\n        return 'Anthropic';\n      default:\n        return capitalize(provider);\n    }\n  }\n\n  function getMissingKeyMessage() {\n    return `Set your ${formatProviderName(activeModelProvider)} API key to send messages.`;\n  }\n\n  function serializePositions(map) {\n    const result = {};\n    map.forEach((value, key) => {\n      result[key] = value;\n    });\n    return result;\n  }\n\n  function updateSearchIndex(nodes) {\n    searchIndex = new Map();\n    nodes.forEach((node) => {\n      const descriptorLabel = typeof node.descriptor?.label === 'string' ? node.descriptor.label : '';\n      const rawValue =\n        typeof node.descriptor?.rawValue === 'string'\n          ? node.descriptor.rawValue\n          : typeof node.descriptor?.rawValue !== 'undefined'\n            ? String(node.descriptor.rawValue)\n            : '';\n      const text = [node.key, descriptorLabel, rawValue].filter(Boolean).join(' ').toLowerCase();\n      searchIndex.set(node.id, { text });\n    });\n\n    if (currentSearchQuery) {\n      if (!searchIndex.has(currentSearchMatch ?? '')) {\n        currentSearchMatch = undefined;\n      }\n    }\n  }\n\n  function performSearch(query) {\n    currentSearchQuery = query;\n    if (!query) {\n      pendingSearchFocusId = undefined;\n      currentSearchMatch = undefined;\n      clearSearchHighlight();\n      return;\n    }\n\n    const normalized = query.toLowerCase();\n    let matchId;\n    for (const [id, payload] of searchIndex) {\n      if (payload.text.includes(normalized)) {\n        matchId = id;\n        break;\n      }\n    }\n\n    if (!matchId) {\n      clearSearchHighlight();\n      currentSearchMatch = undefined;\n      return;\n    }\n\n    currentSearchMatch = matchId;\n    pendingSearchFocusId = matchId;\n\n    if (viewMode !== 'graph') {\n      setViewMode('graph');\n      return;\n    }\n\n    focusGraphNode(matchId);\n  }\n\n  function clearSearchHighlight() {\n    nodeElements.forEach(({ element }) => element.classList.remove('is-search-hit'));\n    treeRoot.querySelectorAll('.tree-node.is-search-hit').forEach((node) => node.classList.remove('is-search-hit'));\n  }\n\n  function applySearchHighlight() {\n    clearSearchHighlight();\n    if (!currentSearchQuery || viewMode !== 'graph') {\n      return;\n    }\n\n    if (currentSearchMatch && nodeElements.has(currentSearchMatch)) {\n      nodeElements.get(currentSearchMatch).element.classList.add('is-search-hit');\n    }\n  }\n\n  function focusGraphNode(nodeId) {\n    const entry = nodeElements.get(nodeId);\n    if (!entry) {\n      return;\n    }\n\n    nodeElements.forEach(({ element }) => element.classList.remove('is-search-hit'));\n    entry.element.classList.add('is-search-hit');\n\n    const viewportWidth = viewport?.clientWidth ?? 0;\n    const viewportHeight = viewport?.clientHeight ?? 0;\n    const nodeWidth = entry.element.offsetWidth || 0;\n    const nodeHeight = entry.element.offsetHeight || 0;\n    const scale = panState.scale || 1;\n\n    panState.x = viewportWidth / 2 - (entry.node.x + nodeWidth / 2) * scale;\n    panState.y = viewportHeight / 2 - (entry.node.y + nodeHeight / 2) * scale;\n    applyPan();\n    pendingSearchFocusId = undefined;\n  }\n\n  function focusTreeNode(path) {\n    if (!path) {\n      return;\n    }\n    requestAnimationFrame(() => {\n      const selector = `.tree-node[data-path=\"${escapeCss(path)}\"]`;\n      const node = treeRoot.querySelector(selector);\n      if (!(node instanceof HTMLElement)) {\n        return;\n      }\n      node.scrollIntoView({ block: 'center', behavior: 'smooth' });\n      node.classList.add('is-search-hit');\n      if (typeof node.focus === 'function') {\n        node.focus({ preventScroll: true });\n      }\n      setTimeout(() => node.classList.remove('is-search-hit'), 800);\n    });\n  }\n\n  function focusPath(path) {\n    if (!path) {\n      return;\n    }\n    if (viewMode === 'graph') {\n      requestAnimationFrame(() => focusGraphNode(path));\n    } else {\n      focusTreeNode(path);\n    }\n  }\n\n  function setControlsCollapsed(value, options = { persist: true }) {\n    controlsCollapsed = Boolean(value);\n    if (controlDock instanceof HTMLElement) {\n      controlDock.classList.toggle('is-collapsed', controlsCollapsed);\n    }\n    if (controlDockPanel instanceof HTMLElement) {\n      controlDockPanel.setAttribute('aria-hidden', String(controlsCollapsed));\n    }\n    if (controlDockToggle instanceof HTMLButtonElement) {\n      controlDockToggle.setAttribute('aria-expanded', String(!controlsCollapsed));\n      controlDockToggle.title = controlsCollapsed ? 'Show controls' : 'Hide controls';\n      controlDockToggle.setAttribute('aria-label', controlsCollapsed ? 'Show controls' : 'Hide controls');\n    }\n    if (options.persist !== false) {\n      persistState();\n    }\n  }\n\n  function toggleChatPanel(forceState) {\n    if (!(chatPanel instanceof HTMLElement)) {\n      return;\n    }\n\n    const nextState = typeof forceState === 'boolean' ? forceState : !chatPanelVisible;\n    chatPanelVisible = nextState;\n    if (nextState) {\n      chatPanel.removeAttribute('hidden');\n      if (chatInput instanceof HTMLTextAreaElement) {\n        chatInput.focus();\n      }\n    } else {\n      chatPanel.setAttribute('hidden', 'true');\n    }\n  }\n\n  function applySelectionInfo(info) {\n    if (info && typeof info === 'object') {\n      selectionActive = Boolean(info.active);\n      const startLine = typeof info.startLine === 'number' ? info.startLine + 1 : undefined;\n      const endLine = typeof info.endLine === 'number' ? info.endLine + 1 : undefined;\n      const hasRange = typeof startLine === 'number' && typeof endLine === 'number';\n      selectionLineRange = selectionActive && hasRange ? { start: startLine, end: endLine } : {};\n    } else {\n      selectionActive = false;\n      selectionLineRange = {};\n    }\n    updateSelectionIndicator();\n  }\n\n  function updateSelectionIndicator() {\n    updateSelectionInputs();\n  }\n\n  function updateSelectionInputs() {\n    if (!(selectionStartInput instanceof HTMLInputElement) || !(selectionEndInput instanceof HTMLInputElement)) {\n      return;\n    }\n\n    if (typeof selectionLineRange.start === 'number') {\n      selectionStartInput.value = String(selectionLineRange.start);\n    } else if (!selectionStartInput.matches(':focus')) {\n      selectionStartInput.value = '';\n    }\n\n    if (typeof selectionLineRange.end === 'number') {\n      selectionEndInput.value = String(selectionLineRange.end);\n    } else if (!selectionEndInput.matches(':focus')) {\n      selectionEndInput.value = '';\n    }\n  }\n\n  function updateModelSelect(payload) {\n    if (!(chatModelSelect instanceof HTMLSelectElement)) {\n      return;\n    }\n\n    const options = Array.isArray(payload?.options) ? payload.options : [];\n    const selectedId = typeof payload?.selectedId === 'string' ? payload.selectedId : '';\n    if (typeof payload?.selectedProvider === 'string') {\n      activeModelProvider = payload.selectedProvider;\n    }\n    chatModelSelect.innerHTML = '';\n\n    if (!options.length) {\n      const placeholder = document.createElement('option');\n      placeholder.value = '';\n      placeholder.textContent = 'No models';\n      chatModelSelect.appendChild(placeholder);\n      chatModelSelect.disabled = true;\n      return;\n    }\n\n    options.forEach((option) => {\n      if (!option || typeof option !== 'object') {\n        return;\n      }\n      const element = document.createElement('option');\n      element.value = String(option.id ?? '');\n      element.textContent = option.label ?? option.id ?? 'Model';\n      if (option.description) {\n        element.title = option.description;\n      }\n      chatModelSelect.appendChild(element);\n    });\n\n    chatModelSelect.disabled = false;\n    if (selectedId) {\n      chatModelSelect.value = selectedId;\n    }\n  }\n\n  function ensureChatPanel() {\n    if (!chatPanelVisible) {\n      toggleChatPanel(true);\n    }\n  }\n\n  function clearChatMessages() {\n    chatMessageMap.clear();\n    if (chatMessages) {\n      chatMessages.innerHTML = '';\n    }\n  }\n\n  function renderChatHistory(messages) {\n    clearChatMessages();\n    if (!Array.isArray(messages)) {\n      return;\n    }\n\n    messages.forEach((entry) => setChatMessage(entry?.id, entry?.role ?? 'assistant', entry?.text ?? ''));\n  }\n\n  function setChatMessage(id, role, text, options = {}) {\n    if (!id) {\n      return;\n    }\n    const record = getOrCreateChatRecord(id, role);\n    record.text = options.pending ? '' : text;\n    record.element.classList.toggle('is-pending', Boolean(options.pending));\n    record.content.innerHTML = renderChatHtml(record.text, options.pending);\n    scrollChatToBottom();\n    showChatStatus('');\n  }\n\n  function appendChatDelta(id, delta) {\n    if (!id || !delta) {\n      return;\n    }\n    const record = getOrCreateChatRecord(id, 'assistant');\n    record.element.classList.remove('is-pending');\n    const isThinkingPlaceholder =\n      typeof record.text === 'string' && record.text.trim().startsWith('AI is thinking');\n    const current = isThinkingPlaceholder ? '' : record.text || '';\n    record.text = current + delta;\n    record.content.innerHTML = renderChatHtml(record.text);\n    scrollChatToBottom();\n    showChatStatus('');\n  }\n\n  function finalizeAssistantMessage(id, text, snippet) {\n    if (!id) {\n      return;\n    }\n    const record = getOrCreateChatRecord(id, 'assistant');\n    record.text = text;\n    record.element.classList.remove('is-pending');\n    record.content.innerHTML = renderChatHtml(text);\n\n    const existing = record.element.querySelector('.chat-message__actions');\n    if (existing) {\n      existing.remove();\n    }\n\n    if (snippet) {\n      const actions = document.createElement('div');\n      actions.className = 'chat-message__actions';\n      const button = document.createElement('button');\n      button.type = 'button';\n      button.textContent = 'Apply snippet';\n      button.addEventListener('click', () => {\n        vscode.postMessage({ type: 'chat:applySnippet', payload: { content: snippet } });\n      });\n      actions.appendChild(button);\n      record.element.appendChild(actions);\n    }\n\n    scrollChatToBottom();\n  }\n\n  function getOrCreateChatRecord(id, role) {\n    let record = chatMessageMap.get(id);\n    if (!record) {\n      const wrapper = document.createElement('div');\n      wrapper.className = `chat-message chat-message--${role}`;\n      const content = document.createElement('div');\n      content.className = 'chat-message__content';\n      wrapper.appendChild(content);\n      chatMessages?.appendChild(wrapper);\n      record = { element: wrapper, content, text: '' };\n      chatMessageMap.set(id, record);\n    }\n    return record;\n  }\n\n  function scrollChatToBottom() {\n    if (!chatMessages) {\n      return;\n    }\n    requestAnimationFrame(() => {\n      chatMessages.scrollTop = chatMessages.scrollHeight;\n    });\n  }\n\n  function showChatStatus(text) {\n    if (!(chatStatus instanceof HTMLElement)) {\n      return;\n    }\n\n    const normalized = typeof text === 'string' ? text.trim() : '';\n    const isThinking =\n      normalized === 'Thinking…' ||\n      normalized === 'Thinking...' ||\n      normalized === 'AI is thinking…' ||\n      normalized === 'AI is thinking...';\n\n    if (isThinking) {\n      chatStatus.innerHTML =\n        'AI is thinking<span class=\"chat-status__dots\"><span>.</span><span>.</span><span>.</span></span>';\n      chatStatus.classList.add('is-thinking');\n      return;\n    }\n\n    chatStatus.textContent = text || '';\n    chatStatus.classList.remove('is-thinking');\n  }\n\n  function renderChatHtml(text, pending) {\n    if (pending) {\n      return `<span class=\"chat-pending-dots\"><span></span><span></span><span></span></span>`;\n    }\n\n    const escape = (value) =>\n      value\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;');\n\n    const codeRegex = /```(\\w+)?\\s*([\\s\\S]*?)```/g;\n    let lastIndex = 0;\n    let html = '';\n    let match;\n    while ((match = codeRegex.exec(text)) !== null) {\n      html += escape(text.slice(lastIndex, match.index));\n      const lang = match[1]?.trim() ?? 'json';\n      const code = escape(match[2].trim());\n      html += `<pre class=\"chat-code\"><code class=\"lang-${lang}\">${code}</code></pre>`;\n      lastIndex = codeRegex.lastIndex;\n    }\n    html += escape(text.slice(lastIndex));\n    return html;\n  }\n\n  function escapeCss(value) {\n    if (typeof CSS !== 'undefined' && typeof CSS.escape === 'function') {\n      return CSS.escape(value);\n    }\n    return String(value).replace(/[\"\\\\]/g, '\\\\$&');\n  }\n\n})();\n"],"names":["vscode","container","status","viewSelect","searchInput","chatToggle","chatPanel","chatClose","chatReset","chatMessages","chatForm","chatInput","chatStatus","chatModelSelect","selectionLineForm","selectionStartInput","selectionEndInput","selectionClearButton","controlDock","controlDockPanel","controlDockToggle","graphRoot","treeRoot","nodeElements","pathDepths","collapsedPathStore","depthExpandedPathStore","collapsedPaths","depthExpandedPaths","persistedState","_a","nodePositionStore","_b","nodePositions","currentDocumentId","currentEdges","activeNodeDrag","currentPayload","viewport","canvas","nodesLayer","linksLayer","isPanning","panPointerId","panStart","panOrigin","hasUserMovedView","viewMode","hasPersistedViewPreference","graphAutoScale","manualGraphScale","graphInitialScale","graphMaxDepth","searchIndex","currentSearchQuery","currentSearchMatch","pendingSearchFocusId","chatMessageMap","chatPanelVisible","awaitingChatKey","hasAiKey","selectionActive","selectionLineRange","controlsCollapsed","needsInitialGraphFocus","activeModelProvider","NODE_GAP_X","NODE_GAP_Y","CANVAS_PADDING","MANUAL_MIN_SCALE","AUTO_MIN_SCALE","AUTO_MAX_SCALE","AUTO_FIT_PADDING","AUTO_VISIBLE_MIN_SCALE","MAX_SCALE","ICON_TYPES","EDITABLE_VALUE_KINDS","ROOT_PATH","ICON_SVGS","panState","minScaleLimit","event","next","setViewMode","value","performSearch","toggleChatPanel","showChatStatus","getMissingKeyMessage","clearChatMessages","submitChatInput","startValue","parseLineInput","endValue","normalized","normalizeLineRange","updateSelectionInputs","setControlsCollapsed","handleContainerClick","handleKeydown","type","payload","renderVisualizer","renderInvalidState","renderChatHistory","ensureChatPanel","setChatMessage","appendChatDelta","finalizeAssistantMessage","_c","updateModelSelect","applySelectionInfo","path","focusGraphNode","persistState","options","serializePositions","switchDocument","documentId","stored","collapsed","expanded","pruneNodePositions","validIds","changed","id","target","editValueTarget","literal","kind","href","requestEditValue","link","renameTarget","currentName","requestRename","toggle","togglePath","isAutoCollapsedPath","rerenderFromState","focusPath","rememberPathDepth","pathKey","depth","getActiveDepthLimit","shouldCollapseByDepth","limit","initViewport","setupPanAndZoom","deltaX","deltaY","applyPan","endPan","pointerToRelease","factor","nextScale","clamp","rect","offsetX","offsetY","scaleRatio","resetPan","force","scaleOverride","host","viewportWidth","viewportHeight","canvasRect","canvasWidth","canvasHeight","targetScale","normalizedScale","updateMinScaleLimit","initialScale","renderData","mode","data","defaultViewMode","initialSelectionInfo","clampScale","hideStatus","graphData","buildGraph","updateSearchIndex","renderTreeView","renderGraph","graph","node","element","createGraphNodeElement","drawEdges","computeAutoScale","applySearchHighlight","tree","buildTreeBranch","key","serializePath","entries","getChildEntries","hasChildren","depthLimited","isCollapsed","listItem","control","chevron","keySpan","canRename","connector","descriptor","describeValue","valueElement","createValueElement","canEditValueDescriptor","childList","childKey","childValue","childPath","childLabel","formatChildKey","message","updateSelectionIndicator","nodes","edges","maxDepth","nextRow","traverse","parentId","children","lastSegment","childPositions","top","bottom","width","height","custom","enableNodeDragging","shouldStartNodeDrag","newX","newY","updateNodePosition","endDrag","finishNodeDrag","edge","parent","child","parentWidth","parentHeight","childHeight","startX","startY","endX","endY","controlOffset","nodeId","x","y","entry","moved","index","isObject","trimmed","isUrl","truncate","serializeValueLiteral","rawValue","className","icon","createIconElement","textSpan","baseTitle","editHint","span","markup","svg","graphSize","nodeCount","heuristicScale","clampAutoScale","computeDensityScale","fitScale","computeFitScale","candidate","padded","min","max","parentLabel","parentValue","baseLabel","deriveArrayItemLabel","numeric","suffix","lower","capitalize","parsed","start","end","formatProviderName","provider","map","result","descriptorLabel","text","query","clearSearchHighlight","matchId","nodeWidth","nodeHeight","scale","focusTreeNode","selector","escapeCss","forceState","nextState","info","startLine","endLine","selectedId","placeholder","option","messages","role","record","getOrCreateChatRecord","renderChatHtml","scrollChatToBottom","delta","current","snippet","existing","actions","button","wrapper","content","pending","escape","codeRegex","lastIndex","html","match","lang","code"],"mappings":"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"}